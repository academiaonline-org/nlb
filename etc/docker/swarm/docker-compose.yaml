#########################################################################
#      Copyright (C) 2020        Sebastian Francisco Colomar Bauza      #
#      SPDX-License-Identifier:  GPL-2.0-only                           #
#########################################################################

configs:
  nlb:
    file: /run/configs/etc/nginx/conf.d/nlb.conf
services:
  nlb:
    configs:
    - 
      mode: 0440
      source: nlb
      target: /etc/nginx/conf.d/nlb.conf
    deploy:
      placement:
        constraints:
        - node.role == worker
      replicas: 1
    image: "secobau/nginx:5.0@sha256:5a66a33f5ef6ad2f6c195fba7f2c6f4fb2f6d06828297a9b47158783454d53a3"
    ports:
    - "6443:6443"
    volumes:
    - nlb:/var/log/nginx
version: '3.8'
volumes:
  nlb:
